<h1> <%= @user.name %>'s page </h1>



<%= image_tag @user.avatar.url(:thumb) %>

<p>profile page tbd</p>

<!-- ========== Google Maps ============== -->
    <div id="map"></div>

    <% @fsa_array = [] %>
    <% User.all.each do |user|%>
      <% hasher = { fsa_name: user.fsa.name, lat: user.fsa.latitude, lng: user.fsa.longitude}  %>
      <% @fsa_array << hasher %>
    <% end %>

    <%=tag("div", :id => 'fsa_data', :data => {:fsa => @fsa_array})%>

    <script>
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 43.647219, lng: -79.387905},
          zoom: 12,
          styles: purple
        });


        var marker = new google.maps.Marker({
         position: {lat: 43.647219, lng: -79.387905},
         map: map,
         title: 'Hello World!'
        });

       var fsaElement = document.getElementById('fsa_data');
       var fsaData = JSON.parse(fsaElement.dataset.fsa);
       console.warn(fsaData);
       var fsaPopulations = {}

       for (i = 0; i < fsaData.length; i ++) {
         var currentFsa = fsaData[i];
         if (fsaPopulations[currentFsa['fsa_name']] > 0) {
           fsaPopulations[currentFsa['fsa_name']] += 1;
         } else {
           fsaPopulations[currentFsa['fsa_name']] = 1;
         }
       }

       for (var key in fsaPopulations) {
         count = fsaPopulations[key]
         later = 0.0;
         longer = 0.0;
         for (i = 0; i < fsaData.length; i ++) {
           if (key === fsaData[i].fsa_name) {
             later = fsaData[i].lat;
             longer = fsaData[i].lng;
           }
           new google.maps.Circle({
             strokeColor: '#FF0000',
             strokeOpacity: 0.8,
             strokeWeight: 2,
             fillColor: '#FF0000',
             fillOpacity: 0.35,
             center: {lat: later, lng: longer},
             map: map,
             radius: count * 100
           });
         }


       }

       // for (i = 0; i < fsaPopulations.length; i ++) {
       //   var currentPop = fsaPopulations[i];
       //
       //   new google.maps.Circle({
       //     strokeColor: '#FF0000',
       //     strokeOpacity: 0.8,
       //     strokeWeight: 2,
       //     fillColor: '#FF0000',
       //     fillOpacity: 0.35,
       //     position: {lat: , lng:},
       //     map: map,
       //     radius: 100
       //   })
       // }

       // var cityCircle = new google.maps.Circle({
       //   strokeColor: '#FF0000',
       //   strokeOpacity: 0.8,
       //   strokeWeight: 2,
       //   fillColor: '#FF0000',
       //   fillOpacity: 0.35,
       //   map: map,
       //   center: citymap[city].center,
       //   radius: Math.sqrt(citymap[city].population) * 100
       // });

       //   new google.maps.Marker({
       //     position: {lat: currentFsa['lat'], lng: currentFsa['lng']},
       //     map: map
       //   });
       // }
     }


      function mark_users(lati, long) {
        var markerX = new google.maps.Marker({
         position: {lat: lati, lng: long},
         map: map,
         title: 'Hello World!'
         });
      }

    </script>

    <!-- ========== Google Maps End ============== -->

    <script src="https://maps.googleapis.com/maps/api/js?key=<%=ENV["Google_key"]%>&callback=initMap"
    async defer></script>
  </body>
</html>


<script>
  var purple =
[
    {
        "featureType": "all",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "simplified"
            },
            {
                "hue": "#bc00ff"
            },
            {
                "saturation": "0"
            }
        ]
    },
    {
        "featureType": "administrative",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "administrative",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "color": "#e8b8f9"
            }
        ]
    },
    {
        "featureType": "administrative.country",
        "elementType": "labels",
        "stylers": [
            {
                "color": "#ff0000"
            }
        ]
    },
    {
        "featureType": "administrative.land_parcel",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "landscape",
        "elementType": "all",
        "stylers": [
            {
                "color": "#3e114e"
            },
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "landscape",
        "elementType": "labels",
        "stylers": [
            {
                "visibility": "off"
            },
            {
                "color": "#a02aca"
            }
        ]
    },
    {
        "featureType": "landscape.natural",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "simplified"
            },
            {
                "color": "#2e093b"
            }
        ]
    },
    {
        "featureType": "landscape.natural",
        "elementType": "labels.text",
        "stylers": [
            {
                "color": "#9e1010"
            },
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "landscape.natural",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "color": "#ff0000"
            }
        ]
    },
    {
        "featureType": "landscape.natural.landcover",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "simplified"
            },
            {
                "color": "#58176e"
            }
        ]
    },
    {
        "featureType": "landscape.natural.landcover",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "poi",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "poi.business",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "all",
        "stylers": [
            {
                "saturation": -100
            },
            {
                "lightness": 45
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "geometry",
        "stylers": [
            {
                "visibility": "simplified"
            },
            {
                "color": "#a02aca"
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "labels",
        "stylers": [
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "color": "#d180ee"
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "labels.text.stroke",
        "stylers": [
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "geometry",
        "stylers": [
            {
                "visibility": "simplified"
            },
            {
                "color": "#a02aca"
            }
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "labels",
        "stylers": [
            {
                "visibility": "off"
            },
            {
                "color": "#ff0000"
            }
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "labels.text",
        "stylers": [
            {
                "color": "#a02aca"
            },
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "color": "#cc81e7"
            },
            {
                "visibility": "simplified"
            }
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "labels.text.stroke",
        "stylers": [
            {
                "visibility": "simplified"
            },
            {
                "hue": "#bc00ff"
            }
        ]
    },
    {
        "featureType": "road.arterial",
        "elementType": "geometry",
        "stylers": [
            {
                "color": "#6d2388"
            }
        ]
    },
    {
        "featureType": "road.arterial",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "color": "#c46ce3"
            }
        ]
    },
    {
        "featureType": "road.arterial",
        "elementType": "labels.icon",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "transit",
        "elementType": "all",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "water",
        "elementType": "all",
        "stylers": [
            {
                "color": "#b7918f"
            },
            {
                "visibility": "on"
            }
        ]
    },
    {
        "featureType": "water",
        "elementType": "geometry",
        "stylers": [
            {
                "color": "#280b33"
            }
        ]
    },
    {
        "featureType": "water",
        "elementType": "labels",
        "stylers": [
            {
                "visibility": "simplified"
            },
            {
                "color": "#a02aca"
            }
        ]
    }
]
</script>
